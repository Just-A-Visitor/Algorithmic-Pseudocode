Clean the code and update the explanation
